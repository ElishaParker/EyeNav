<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EyeNav Minimal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0; padding: 0;
      width: 100vw; height: 100vh;
      background: black;
      overflow: hidden;
    }
    #dot {
      position: fixed;
      width: 16px; height: 16px;
      background: cyan;
      border-radius: 50%;
      pointer-events: none;
      mix-blend-mode: difference;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%);
    }
  </style>

  <!-- Load WebGazer -->
  <script src="https://cdn.jsdelivr.net/npm/webgazer/dist/webgazer.min.js"></script>
</head>
<body>
  <div id="dot"></div>

  <script>
    // Wait until WebGazer is ready
    window.addEventListener('load', () => {
      const dot = document.getElementById('dot');
      let smoothX = window.innerWidth / 2;
      let smoothY = window.innerHeight / 2;
      const smoothFactor = 0.2;

      // --- Initialize WebGazer ---
      webgazer.setRegression('ridge')
        .setTracker('clmtrackr')
        .begin()
        .then(() => {
          // Turn off all built-in visuals
          webgazer.showVideo(false);
          webgazer.showFaceOverlay(false);
          webgazer.showFaceFeedbackBox(false);
          webgazer.showPredictionPoints(false);
          // Disable default system cursor dot if present
          if (webgazer.params) {
            webgazer.params.showGazeDot = false;
            webgazer.params.applyKalmanFilter = true;
          }
        });

      // --- Custom gaze listener ---
      webgazer.setGazeListener((data) => {
        if (!data) return;
        smoothX = smoothX * (1 - smoothFactor) + data.x * smoothFactor;
        smoothY = smoothY * (1 - smoothFactor) + data.y * smoothFactor;
        dot.style.left = `${smoothX - 8}px`;
        dot.style.top  = `${smoothY - 8}px`;
      });

      // --- Resize safety ---
      window.addEventListener('resize', () => {
        smoothX = window.innerWidth / 2;
        smoothY = window.innerHeight / 2;
      });
    });
  </script>
</body>
</html>
